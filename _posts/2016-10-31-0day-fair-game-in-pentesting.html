---
layout: post
title: 0day - Fair game in pentesting?
date: 2016-10-31 17:26:00.000000000 +03:00
type: post
published: true
status: publish
categories:
- Original content
tags: []
author:
  email: jw@jw.fi
  display_name: Jan Wikholm
  first_name: ''
  last_name: ''
excerpt: |-
  I argue that using 0day exploits in a pentesting engagement is fair game if you happen upon such a scenario.
  Unless they are explicitly ruled as out-of-bounds per the contract, it would be artificially limiting yourself 
  from things that adversaries have access to anyway.
---

<p><a href="https://www.youtube.com/watch?v=XOnsX9f_ajc">https://www.youtube.com/watch?v=XOnsX9f_ajc</a></p>
<script>
document.write('<iframe width="560" height="315" src="https://www.youtube.com/embed/XOnsX9f_ajc" frameborder="0" allowfullscreen></iframe>');
</script>

<p>It started with an innocent, semi tongue-in-cheek question on #offsec last week.</p>

<blockquote>
	anyone root any machines with dirtycow in the labs yet? :)
</blockquote>

<p>The <a href="https://dirtycow.ninja/">DirtyCOW Linux 0day exploit</a> had just recently hit the public consciousness despite being a vulnerability in the source for the past 9 years already. (Consequently probably <a href="http://arstechnica.com/security/2016/10/android-phones-rooted-by-most-serious-linux-escalation-bug-ever/">the single biggest Android vuln to exist</a> that probably also won't get patched).</p>

<p>The basic argument against using it wasn't that it wasn't kosher with OffSec but:
<blockquote>"when doing a real pentest, you can't fault the IT team for not patching brand new vulnerabilites"</blockquote>
</p>

<p>That really struck a nerve with me. Because that sort of implied that what I do as a security consultant is running around <strong>blaming</strong> or <strong>faulting</strong> people versus helping companies find the weak spots in order to fix them.</p>

<p>That goes against the main premise that I have gone into every security consulting scenario: I want to let the people we are interacting know that we are not there to blame anyone but to uncover issues that they might not have visibility into. <em>Or</em> potentially issues that IT is fully aware of but is not getting resources to fix until someone external party comes and validates the need for more money / time / people.</p>

<p>The retort went something on the lines of 
<blockquote>Executives only read executive summary and will see x out of y systems compromised and then proceed to fire people</blockquote>

And that I should find some other way to root the machine and report on that.
</p>

<p>This felt absurd to me at first glance. But now with more time to ponder, I can see that this can be, and probably is, a real worry in some organizations.</p>

<p>But that's a <em>systemic problem</em> in management.</p>

<p>It also makes the situation really black and white, which is quite often the case whenever you try to argue rationally any subject over a text-based chat. It removes the nuances required to make sure both of your assumptions of the situation are aligned. For example if the other person has only seen pentest reports which did not put the amount of vulnerabilities into any sort of scale vs other companies in the same vertical, it might be quite alarming to see 99 CRITICAL VULNERABILITIES FOUND!</p>

<p>But if you give some background information "in an organization of size 100-300 machines/people we usually expect to find 1-2 machines with tens of critical vulnerabilities which can skew the statistics" or some such, it will give context to the executive that might then understand what exactly "12 out of 53 systems compromised" means or at least not start summarily terminating the very same people who are supposed to fix the situation. Sidenote: I also hope that the executive summary is longer than just a few one-liner bulletpoints.</p>

<p>If I get local shell on a server and THEN a local 0day priv-esc lands on my lap, then yes I will use it.</p>

<p>I will then explain that this and this step should be taken to mitigate the way I got local access in the first place. The most critical point usually is getting local execution and there are many steps you can take to try and prevent that.</p>

<p>In addition there are mitigations (grsec, selinux, emet etc) to prevent local execution for some set of exploits.</p>

<p>There are tripwires you can setup to know <em>when the compromise happens</em> even if you cannot prevent it. This should hopefully translate to a faster response to quarantine and remedy the situation. This of course depends on what sort of SLAs you have for your IT/security guys to respond to incidents, but that is beside the point. The point is that you cannot rely on one facet of your security posture, you need layers. So me using a 0day to punch through one of these layers will not invalidate all of the other mitigations that could and should be in place.</p>

<p>Using the 0day in an engagement will solidify all of your hypothetical attack scenarios for phishing awareness and understanding of layered security practices. It means that when I show you in the Nessus scan that vulnerability that "May lead to local unprivileged execution" it then becomes effectively "Remote Code Execution with root privileges" for all systems that are affected by a local privilege escalation exploit.</p>

<p>Is it "fair" to use 0day?</p>

<blockquote>I think that anything that adversaries can use is fair game.</blockquote>

<p>But as said, what is fair contractually may vary. Ethically I have no qualms over using 0days.</p>

<p>Whether or not people get fired due to the findings of a pentest is up to the management. It is not the pen-tester's job to sugarcoat findings. Only thing we do is give context and bring awareness. 0days happen. Some of them are local priv-esc, some of them are remote code exec (think shellshock).</p>

<p>Not using them if you find one that fits seems like a wasted opportunity to underline how volatile our notions of secure are. Not to blame, but to educate.</p>

<p>And as I said, text-based arguments are quite often quite futile given how easily misaligned our perceptions of reality are. Those misalignments are obviously colored by our experiences. If you only have experienced lousy management instead of good leadership and have worked under a constant worry of being replaced by outsourcing or downsizing or being fired for any and all mistakes or whatever, then yeah, I can totally understand why you might have such perspectives. I have my own experiences as the reporter of <em>faults</em> and I know how I have conveyed the findings both in text and spoken form and as far as I know those did not lead to firings. And no, no 0days dropped on my lap during those engagements.</p>

<p><strong>Thoughts</strong>? Tweet at me, shout at me, email me, comment below where I have linked this.</p>