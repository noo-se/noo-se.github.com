---
layout: post
title: 'CVE-2015-7547: glibc getaddrinfo stack-based buffer overflow'
date: 2016-02-16 17:42:41.000000000 +03:00
type: post
published: true
status: publish
categories:
- Curated links
tags:
- glibc
- rce
- stackoverflow
- vuln
meta:
  _oembed_af4b6add44b95dee5e0c072f78b126f7: '{{unknown}}'
  _rest_api_published: '1'
  _rest_api_client_id: '43452'
  _publicize_job_id: '19861626516'
  publicize_linkedin_url: https://www.linkedin.com/updates?discuss=&scope=106127&stype=M&topic=6105370530125275136&type=U&a=CgRu
  _publicize_done_13656638: '1'
  _wpas_done_13596824: '1'
  _publicize_done_external: a:2:{s:7:"twitter";a:1:{i:13596827;s:50:"https://twitter.com/unfo/status/699604844773011457";}s:8:"facebook";a:1:{i:13596832;s:38:"https://facebook.com/10153983046413281";}}
  _publicize_done_13656641: '1'
  _wpas_done_13596827: '1'
  publicize_twitter_user: unfo
  _publicize_done_13656646: '1'
  _wpas_done_13596832: '1'
  publicize_tumblr_url: http://.tumblr.com/post/139423343720
  _publicize_done_13656651: '1'
  _wpas_done_13596836: '1'
author:
  login: jwikholm
  email: jw@jw.fi
  display_name: Jan Wikholm
  first_name: ''
  last_name: ''
---
<p>Sources:</p>
<ul>
<li><a href="https://googleonlinesecurity.blogspot.fi/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html">https://googleonlinesecurity.blogspot.fi/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html</a></li>
<li><a href="https://sourceware.org/ml/libc-alpha/2016-02/msg00416.html">https://sourceware.org/ml/libc-alpha/2016-02/msg00416.html</a></li>
</ul>
<h2>What?</h2>
<blockquote><p>During upstream review of the public open bug 18665 for glibc, it was<br />
discovered that the bug could lead to a stack-based buffer overflow.</p></blockquote>
<h2>Exploitation</h2>
<blockquote><p>Remote code execution is possible, but not straightforward. It requires bypassing the security mitigations present on the system, such as ASLR</p></blockquote>
<p><a href="https://sourceware.org/ml/libc-alpha/2016-02/msg00416.html" target="_blank">Mitigations</a></p>
<p>- Mitigating factors for UDP include:<br />
- A firewall that drops UDP DNS packets &gt; 512 bytes.<br />
- A local resolver (that drops non-compliant responses).<br />
- Avoid dual A and AAAA queries (avoids buffer management error) e.g.<br />
Do not use AF_UNSPEC.<br />
- No use of `options edns0` in /etc/resolv.conf since EDNS0 allows<br />
responses larger than 512 bytes and can lead to valid DNS responses<br />
that overflow.<br />
- No use of `RES_USE_EDNS0` or `RES_USE_DNSSEC` since they can both<br />
lead to valid large EDNS0-based DNS responses that can overflow.</p>
<p>- Mitigating factors for TCP include:<br />
- Limit all replies to 1024 bytes.</p>
